<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cantina Senai | Produtos</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="app-container">
    <aside class="sidebar">
        <div class="logo">Espaço Gourmet - Senai</div>
        <nav>
            <ul>
                <li><a href="dashboard.html">Dashboard</a></li>
                <li class="ativo"><a href="produtos.html">Produtos</a></li>
                <li><a href="pedidos.html">Pedidos</a></li>
                <li><a href="relatorios.html">Relatórios</a></li>
                <li><a href="configuracoes.html">Configurações</a></li>
                <li><a href="index.html" class="logout">Sair</a></li>
            </ul>
        </nav>
    </aside>

    <div class="main-content">
        <header class="header">
            <h2>Produtos</h2>
            <div class="user-info">
                <span>Olá, <span id="usuarioLogado"></span>!</span>
            </div>
        </header>

        <main class="content-area">
            <button id="btnNovoProduto">+ Novo Produto</button>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nome</th>
                        <th>Preço (R$)</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody id="tabelaProdutos"></tbody>
            </table>
        </main>
    </div>
</div>

<!-- Modal Produto -->
<div id="modalProduto" class="modal">
    <div class="modal-conteudo">
        <span class="fechar-modal">&times;</span>
        <h2 id="tituloModalProduto">Adicionar Produto</h2>
        <form id="formProduto">
            <input type="hidden" id="produtoId" value="">
            <div class="form-grupo">
                <label for="nomeProduto">Nome:</label>
                <input type="text" id="nomeProduto" required>
            </div>
            <div class="form-grupo">
                <label for="precoProduto">Preço (R$):</label>
                <input type="number" id="precoProduto" step="0.01" min="0" required>
            </div>
            <button type="submit">Salvar</button>
        </form>
    </div>
</div>

<script>
const usuario = localStorage.getItem("usuarioLogado");
if(!usuario) window.location.href = "index.html";
else document.getElementById("usuarioLogado").textContent = usuario;

// Produtos
let produtos = [
    {id: 1, nome: "Coxinha", preco: 5.00},
    {id: 2, nome: "Suco Laranja", preco: 7.50}
    {id: 3, nome: "Pastel", preco: 10.00},
    {id: 4, nome: "Pizza Pedaços", preco: 9.50}
    {id: 5, nome: "X-Salada", preco: 12.00},
    {id: 6, nome: "Suco Coca-Cola", preco: 6.50}
];
let proximoIdProduto = 3;

const corpoTabela = document.getElementById("tabelaProdutos");
const modal = document.getElementById("modalProduto");
const btnNovo = document.getElementById("btnNovoProduto");
const fechar = document.querySelector(".fechar-modal");
const form = document.getElementById("formProduto");
const tituloModal = document.getElementById("tituloModalProduto");

function renderizarProdutos() {
    corpoTabela.innerHTML = "";
    produtos.forEach(prod => {
        const linha = corpoTabela.insertRow();
        linha.insertCell().textContent = prod.id;
        linha.insertCell().textContent = prod.nome;
        linha.insertCell().textContent = prod.preco.toFixed(2).replace(".", ",");
        const celulaAcoes = linha.insertCell();

        const btnEditar = document.createElement("button");
        btnEditar.textContent = "Editar";
        btnEditar.className = "btn-editar";
        btnEditar.onclick = () => abrirModal("editar", prod);
        celulaAcoes.appendChild(btnEditar);

        const btnExcluir = document.createElement("button");
        btnExcluir.textContent = "Excluir";
        btnExcluir.className = "btn-excluir";
        btnExcluir.onclick = () => {
            if(confirm(`Excluir produto ${prod.nome}?`)){
                produtos = produtos.filter(p => p.id !== prod.id);
                renderizarProdutos();
            }
        };
        celulaAcoes.appendChild(btnExcluir);
    });
}

function abrirModal(modo, prod = {}) {
    modal.style.display = "flex";
    if(modo === "adicionar") {
        tituloModal.textContent = "Adicionar Produto";
        form.reset();
        document.getElementById("produtoId").value = "";
    } else {
        tituloModal.textContent = `Editar Produto #${prod.id}`;
        document.getElementById("produtoId").value = prod.id;
        document.getElementById("nomeProduto").value = prod.nome;
        document.getElementById("precoProduto").value = prod.preco;
    }
}

function fecharModal() { modal.style.display = "none"; }

btnNovo.onclick = () => abrirModal("adicionar");
fechar.onclick = fecharModal;
window.onclick = e => { if(e.target==modal) fecharModal(); };

form.addEventListener("submit", e => {
    e.preventDefault();
    const id = document.getElementById("produtoId").value;
    const nome = document.getElementById("nomeProduto").value;
    const preco = parseFloat(document.getElementById("precoProduto").value);
    if(id){
        const index = produtos.findIndex(p=>p.id==id);
        if(index!==-1) produtos[index] = {id: parseInt(id), nome, preco};
    } else {
        produtos.push({id: proximoIdProduto++, nome, preco});
    }
    fecharModal();
    renderizarProdutos();
});

renderizarProdutos();
</script>
</body>
</html>

